// 1. Initialize Telegram WebApp
const tg = window.Telegram.WebApp;
tg.expand();

// 2. Read the data from the URL
const urlParams = new URLSearchParams(window.location.search);
const rawData = urlParams.get('data');
const attendanceData = rawData ? JSON.parse(decodeURIComponent(rawData)) : {};

// 3. (Optional) Use Telegram's Main Button for a native look
tg.MainButton.setText("SAVE CHANGES");
tg.MainButton.show();

// 4. Send data back and close when the button is clicked
tg.MainButton.onClick(() => {
    // Collect your edited data from your HTML inputs
    const updatedData = {
        "Alice": document.getElementById('alice-status').value,
        "Bob": "present", // example
        "Charlie": "present"
    };

    // This sends the string to the bot and CLOSES the app automatically
    tg.sendData(JSON.stringify(updatedData));
});
